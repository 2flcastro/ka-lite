{% extends base_template %}
{% load i18n %}
{% load kalite_staticfiles %}

{% block practice_active %}active{% endblock practice_active %}

{% block headcss %}{{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'khan-exercises/css/khan-exercise.css' True %}">

    <!-- Used by KA to dynamically add styling to the exercise -->
    <style id="exercise-inline-style"></style>

{% endblock headcss %}

{% block headjs %}{{ block.super }}
    <script>
        var urlBaseOverride = "{% static 'khan-exercises/' %}";
        // some dummy features on the Exercises object to make khan-exercises.js happy
        Exercises = {
            completeStack: {
                getUid: function() { return 0; },
                getCustomStackID: function() { return 0; }
            },
            currentCard: {
                attributes: {},
                get: function() {}
            },
            RelatedVideos: {
                render: function() {}
            },
            getCurrentFramework: function() { return "khan-exercises"; },
            incompleteStack: [0],
            PerseusBridge: {
                cleanupProblem: function() {}
            }
        };
    </script>
    <script src="{% static 'khan-exercises/khan-exercise.js' True %}"></script>
    <script>
        {# No user data is stored here; that is recovered via an AJAX call, so that this page is fully cacheable #}
        var exerciseData = {
            "basepoints": {{ exercise.basepoints }},
            "description": "{{ exercise.description|linebreaksbr }}",
            "title": "{{ exercise.display_name }}",
            "exerciseModel": {
                "displayName": "{{ exercise.display_name }}",
                "name": "{{ exercise.name }}",
                "secondsPerFastProblem": {{ exercise.seconds_per_fast_problem }},
                "authorName": "{{ exercise.author_name }}",
                "relatedVideos": [],
                "fileName": "{{ exercise_template }}"
            },
            "readOnly": false,
            "percentCompleted": 0,
            "points": 0,
            "starting_points": 0,
            "attempts": 0,
            "exerciseProgress": {
                "level": ""
            },
            "lastCountHints": 0
        };
    </script>

    <script src="{% static "js/handlebars/handlebars-v1.3.0.js" %}"></script>
    <script src="{% static "js/handlebars/handlebars-helpers.js" %}"></script>
    <script src="{% static "js/handlebars/handlebars-wrapper.js" %}"></script>
    <script src="{% url handlebars_templates module_name='exercise' %}"></script>

    <script src="{% static 'js/distributed/exercises.js' %}"></script>
{% endblock headjs %}

{% block content %}
    <div class="exercises-header">

        {% if prev %}
        <div class="vidprev"><a href="{{ prev.path }}">&lt; {% trans prev.title %} <span class="progress-circle" data-exercise-id="{{ prev.id }}"></span></a></div>
        {% endif %}

        {% if next %}
        <div class="vidnext"><a href="{{ next.path }}"><span class="progress-circle" data-exercise-id="{{ next.id }}"></span> {% trans next.title %} &gt;</a></div>
        {% endif %}
        <div class="clear"></div>

    </div>

    <div class="exercise-wrapper"></div>

{% endblock content %}
