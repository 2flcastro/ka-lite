{% extends 'base.html' %}

{% block practice_selected %}selected{% endblock practice_selected %}

{% block headcss %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}khan-exercises/css/khan-exercise.css"></link>
{% endblock headcss %}

{% block headjs %}
<script>
    var urlBaseOverride = "{{ STATIC_URL }}khan-exercises/";
    // some dummy features on the Exercises object to make khan-exercises.js happy
    Exercises = {
        completeStack: {
            getUid: function() { return 0; },
            getCustomStackID: function() { return 0; }
        },
        incompleteStack: [0]
    };
</script>
<script src="{{ STATIC_URL }}js/underscore.js"></script>
<script src="{{ STATIC_URL }}khan-exercises/khan-exercise.js"></script>
<script src="{{ STATIC_URL }}khan-exercises/jquery-ui.js"></script>
<script>

    var exerciseData = {
        "description": "{{ exercise.description }}",
        "title": "{{ exercise.display_name }}",
        "exerciseModel": {
            "displayName": "{{ exercise.display_name }}",
            "name": "{{ exercise.name }}",
            "secondsPerFastProblem": {{ exercise.seconds_per_fast_problem }},
            "authorName": "{{ exercise.author_name }}",
            "relatedVideos": []
        },
        "readOnly": false,
        "percentCompleted": 0
    };

    $(function() {
        $(Exercises).trigger("problemTemplateRendered");
        $(Exercises).trigger("readyForNextProblem", {userExercise: exerciseData});
        $(Khan).bind("checkAnswer", function(ev, data) {
            updatePercentCompleted(data.pass);
        });
        $("#next-question-button").click(function() {
            _.defer(function() {
                $(Exercises).trigger("readyForNextProblem", {userExercise: exerciseData});
            });
        });
    });
    
</script>
{% endblock headjs %}

{% block content %}

    <div class="exercises-header">
        <h2>
            <span class="practice-exercise-topic-context">Practicing</span> {{ title }}
            {% if exercise.description %}<br/><span class="practice-exercise-description">{{ exercise.description }}</span>{% endif %}
        </h2>
    </div>
    <div class="exercises-body">
        <div class="exercises-card current-card">
            <div class="current-card-container card-type-problem">
                <div class="current-card-container-inner vertical-shadow">
                    <div class="current-card-contents">
                        <div id="exercise-message-container" style="display: none;">
                            <div class="exercise_message"></div>
                        </div>
                        <div id="problem-and-answer">
                            <div id='problemarea'>
                                <div id='scratchpad'><div></div></div>
                                <div id='workarea'></div>
                                <div id='hintsarea'></div>
                            </div>
                            <div id="answer_area_wrap"><div id="answer_area">
                                <form id="answerform" action="/exercisedashboard" method="get" name="answerform">
                                    <div id="streakbar" class="info-box">
                                        <div class="streak">
                                            <div class="progress-bar"></div>
                                        </div>
                                    </div>
                                    <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px">
                                    <div id="answercontent" class="info-box">
                                        <span id="examples-show">Acceptable formats</span>
                                        <span class="info-box-header">Answer</span>
                                        <div id="solutionarea" class="fancy-scrollbar"></div>
                                        <ul id="examples" style="display: none"></ul>
                                        <div class="answer-buttons">
                                        <input type="button" class="simple-button green" id="check-answer-button" value="Check Answer"/>
                                        <input type="button" class="simple-button green" id="next-question-button" style="display:none;" name="correctnextbutton" value="Correct! Next Question..."/>
                                        <span id="show-solution-button-container"></span>
                                        <div id="check-answer-results"><p class="check-answer-message info-box-sub-description"></p></div>
                                        </div>
                                    </div>
                                    <div class="info-box hint-box">
                                        <span class="info-box-header">Need help?</span>
                                        <div id="get-hint-button-container">
                                            <input id="hint" type="button" class="simple-button orange full-width" value="I'd like a hint" name="hint"/>
                                        </div>
                                        <span id="hint-remainder"></span>
                                    </div>
                                    <div class="info-box related-video-box" style="display:none;">
                                        <div id="related-video-content">
                                            <span class="info-box-header">Stuck? Watch a video.</span>

                                            <div id="related-video-list">
                                                <span class="related-content-title">Related videos:</span>
                                                <ul class="related-video-list"></ul>
                                            </div>
                                            <div class="clear"></div>
                                        </div>
                                    </div>
                                </form>
                            </div></div>
                            <div class="clear"></div>
                        </div>                        
                    </div>
                </div>
                <div id="extras" class="single-exercise">
                    <ul>
                        <li> <a id="scratchpad-show" href style>Show scratchpad</a>
                            <span id="scratchpad-not-available" style="display: none;">Scratchpad not available</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

<!--
{% for video_id in exercise.related_video_readable_ids %}
<a href="../../v/{{ video_id }}/">{{ video_id }}</a><br/>
{% endfor %}
-->

{% endblock content %}
