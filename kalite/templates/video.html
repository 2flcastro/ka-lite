{% extends 'base.html' %}

{% block watch_selected %}selected{% endblock watch_selected %}

{% block bodyjs %}
<script src="{{ STATIC_URL }}js/swfobject.js"></script>
<script src="{{ STATIC_URL }}js/video.js"></script>
<script>

    var videoData = {
        youtube_id: "{{ video.youtube_id }}",
        points: 0,
        total_seconds_watched: 0,
        last_second_watched: 0,
        last_second_watched_walltime: new Date(),
        seconds_watched_since_save: 0
    };

    $(function() {
        $("#video-thumb").load(function() {
            
            // flashVars.flv = "{{ video.download_urls.mp4 }}";
            flashVars.flv = "/static/videos/{{ video.youtube_id }}.mp4";
            // flashVars.startimage = "{{ video.download_urls.png }}";
            flashVars.startimage = "/static/videos/{{ video.youtube_id }}.png";
            flashVars.srturl = "/static/videos/{{ video.youtube_id }}.srt";
            var width = $("#video-thumb").width();
            var height = $("#video-thumb").height();
            
            $("#video-thumb").css({position: "absolute"});
            $("#video-container").css({height: height});
            
            embedSwf("flash-content", width, height, function(callbackObj) {
                if (callbackObj.success) {
                    setTimeout(function() {
                        $("#flash-container").css("left", "0px");
                        setTimeout(function() {
                            $("#video-thumb").hide();
                            $("#video-container").css("background-color", "white");
                        }, 50);
                    }, 500);
                } else {
                    $("#flash-content").hide();
                }
            });
            
        });
    });
</script>
{% endblock bodyjs %}

{% block content %}
<h2 class="title-header">
    <span class="title">{{ video.title }}</span><br/>
    <span class="long-description">{{ video.description }}</span>
    {% if related_exercise %}
    <a style="float:right; margin-top: -17px; font-size: 14px;" href="{{ related_exercise.path }}" class="practice simple-button green desktop-only" title="Test your understanding with an exercise">Practice this concept</a>
    {% endif %}
</h2>

{% if prev %}
<a style="float: left;" href="../{{ prev.readable_id }}/" data-youtube-id="{{ prev.youtube_id }}">&lt; {{ prev.title }}</a>
{% endif %}

{% if next %}
<a style="float: right; padding-right: 4px;" href="../{{ next.readable_id }}/" data-youtube-id="{{ next.youtube_id }}">{{ next.title }} &gt;</a>
{% endif %}

<div class="clear"></div>

<div id="video-container" style="background-color: black; position: relative;">
    <div id="flash-container" style="position: absolute; left: -10000px;">
        <div id="flash-content"></div>
    </div>
    <img id="video-thumb" src="/static/videos/{{ video.youtube_id }}.png" width="100%">
</div>

<p class="points-container" style="display: none;">Points: <span class="points">0</span></p>

{% endblock content %}
