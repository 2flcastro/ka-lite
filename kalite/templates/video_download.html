{% extends 'base_distributed.html' %}
{% block headcss %}
<link href="{{ STATIC_URL }}css/ui.dynatree.css"rel="stylesheet" type="text/css"/>
<style>
.download_buttons {
	padding: 5px 15px 10px 5px;
	width: 400px;
	float: left;
}

.vertical-shadow{
	width: 400px;
	height: 70px;
}	

.button_text{
	padding: 5px 0px 0px 10px; 
}

.button_style{
	padding: 0px 0px 10px 10px;
}

</style>
{% endblock headcss %}
{% block headjs %}
<script src="{{ STATIC_URL }}js/jquery-ui.custom.min.js"></script>
<script src="{{ STATIC_URL }}js/jquery.dynatree.min.js"></script>


<script type="text/javascript">
  var treeData = [

    {title: "Math", isFolder: true, key: "math",
      children: [
        {
          title: "Algebra",
          addClass: "complete",
          key: "algebra",
          children: [
            {
              title: "Intro",
              key: "intro"
            },
            {title: "Linear function", key: "linear-function" }
          ]
        },
        {title: "Geometry",
        addClass: "partial",
        key: "geometry",
          children: [
            {
              title: "Basic geometry",
              key: "basic-geometry", 
              addClass: "unstarted"
            },
            {title: "Angles", key: "angles" },
            {title: "Triangles", key: "triangles", addClass:"complete"}
          ]
        }
      ]
    },
   
  ];
  
  
   $(function(){ 
   	
   	$("#withSelected").hide();
   	$("#download_videos").hide();
   	
      $("#content_tree").dynatree({
      imagePath:"../images/",
      checkbox: true,
      selectMode: 3,
      children: treeData,
      onSelect: function(select, node) {
      
      	var numberOfVideo = findincomplete().length;
      	
      	if (numberOfVideo > 0){
      		$(".video_count").text(numberOfVideo);
      		$("#withSelected").show();
      		$("#noneSelected").hide();
      		$("#download_videos").show();
      	} else {
      		$("#noneSelected").show();
      		$("#withSelected").hide();
      		$("#download_videos").hide();
      	}
      	

      },
      onDblClick: function(node, event) {
        node.toggleSelect();
      },
      onKeydown: function(node, event) {
        if( event.which == 32 ) {
          node.toggleSelect();
          return false;
        }
      },

      // The following options are only required, if we have more than one tree on one page:
//        initId: "treeData",
      cookieId: "dynatree-Cb3",
      idPrefix: "dynatree-Cb3-"
    });
  
  });
  
	function findincomplete(){
      	var arr = $("#content_tree").dynatree("getSelectedNodes");
      	var arr_incomplete =  $.grep(arr, function(node){	
      		return !$(node.span).hasClass("complete") && node.childList == null; 
      	});
      	
      	return arr_incomplete;
	}
	
	function setNodeClass(nodeKey,className){
		var node = $("#content_tree").dynatree("getTree").getNodeByKey(nodeKey);
		var $span = $(node.span);
		$span.removeClass("unstarted partial complete").addClass(className);
	}
  
</script>

{% endblock headjs %}

{% block content %}

<!-- Dowanload Button -->

<div class="download_buttons">
	<div class="vertical-shadow suggested-action">
        <h2 id="noneSelected" class="button_text">Please select videos to download (below)</h2>
        <h2 id="withSelected" class="button_text">Download <span class="video_count">0</span> video selected below </h2>
        
	<span class= "button_style"><button id="download_videos" type="button">Download Selected Videos</button></span>

	</div>
</div>


<div class="download_buttons">
	<div class="vertical-shadow suggested-action">
	<h2 class="button_text">Download/update subtitles for all videos</h2>

<span class= "button_style">
	<select id="language">
	  <option value="chinese">English</option>
	  <option value="chinese">Chinese</option>
	  <option value="spanish">Spanish</option>
	  <option value="French">French</option>
	  <option value="japanese">Japanese</option>
	</select>
</span>

	<button id="download_subtitles" type="button">Download Subtitles </button>
	
	
	</div>
</div>
<!-- End -->

 <!--  <p class="description">
  </p> -->
  <div style="clear: both;"> </div>
  <div id="content_tree"></div>
{% endblock content %}

