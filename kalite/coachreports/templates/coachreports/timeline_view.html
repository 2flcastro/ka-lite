{% extends "coachreports/base_d3_visualization.html" %}
{% load i18n %}
{% load repeatblock %}
{% load my_filters %}
{% load kalite_staticfiles %}

{% block title %}{{ title }} | {{ block.super }}{% endblock title %}
{% block report_title %}{{ title }}{% endblock report_title %}


{% block headcss %}{{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'css/coachreports/timeline_view.css' %}">
{% endblock headcss %}

{% block headjs %}{{ block.super }}
    <script type="text/javascript" src="{% static 'js/coachreports/d3.multitimeseries.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/coachreports/timeline_view.js' %}"></script>
    <script>
        var ystats = {
            "ex:completion_timestamp": "pct_mastery",
            "vid:completion_timestamp": "pct_mastery",
            "user:last_active_datetime": "user:total_seconds"
        }

        $(function() {
            $("#xaxis").change(function() {
                $("#yaxis option").prop("disabled", true);
                $("#yaxis option[value='" + ystats[$("#xaxis").val()] + "']").prop("disabled", false).prop("selected", true);
                plotTopics(null);
            });
        });
    </script>
{% endblock headjs %}

{% block teach_nav %}
    <div class="teach-nav">
        <ul class="nav navbar-nav">
            <li class="teacher-only"><a href="{% url 'coach_reports' %}" class="active-nav active" title="{% trans 'Track the progress of your students' %}"><img src="{% static "images/coachreports/reports-active-icon.png" %}">{% trans "Reports" %}</a></li>
            <li><a href="{% url 'assign_playlists' %}" class="playlist admin-only teacher-only" title="{% trans 'Assign playlists to student groups' %}"><span>{% trans "Playlists" %}</span></a></li>
            <li><a href="{% url 'test_list' %}" class="exams admin-only teacher-only" title="{% trans 'See list of available tests.' %}"><span>{% trans "Exams" %}</span></a></li>
            <li><a class="learn admin-only teacher-only" href="/" title="{% trans 'KA Lite Home' %}"><span>{% trans "Learn" %}</span></a></li>
        </ul>
    </div>
{% endblock teach_nav %}

{% block subnavbar %}
 <div class="subnav">
        <ul class="nav">
            <li><a href="{% url 'tabular_view' %}">Progress<br>by Topic</a></li>
            <li><a href="{% url 'scatter_view' %}">Effort versus<br>Achievement</a></li>
            <li><a class="active sub-active" href="{% url 'timeline_view' %}">Mastery<br>over Time</a></li>
        </ul>
    </div>
{% endblock subnavbar %}

{% block axis_dropdown %}
    {% trans "X-Axis" %}:
    <select id="xaxis" name="xaxis">
        {% for stat in stats %}
        {% if stat.type == "datetime" %}
        <option value="{{ stat.key }}"{% if stat.key = form|get_item:axis_value %} selected{% endif %}>{% trans stat.name %}</option>
        {% endif %}
        {% endfor %}
    </select>
    {% trans "Y-Axis" %}:
    <select id="yaxis" name="yaxis" class="no-select">
            {% for stat in stats %}
                {% if stat.timeline %}
                    <option value="{{ stat.key }}"{% if stat.key = form|get_item:axis_value %} selected {% else %} disabled {% endif %}>{% trans stat.name %}</option>
                {% endif %}
            {% endfor %}
    </select>
{% endblock axis_dropdown %}
