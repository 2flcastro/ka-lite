{% extends "coachreports/base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load my_filters %}

{% block coachreports_active %}{% endblock coachreports_active %}
{% block selfreports_active %}active{% endblock selfreports_active %}

{% block title %}{% trans "User report" %} {{ block.super }}{% endblock title%}
{% block report_title %}{% trans "User report" %}{% endblock report_title %}

{% block headcss %}{{ block.super }}
    <style>
        .super-header {
            background-color: #ccc;
            font-weight: bold;
        }
        .progress-wrapper{
            display: inline-block; 
        }
        .progress-indicator{
            width:30px;
            height:30px;
            border-radius: 50%/50%;
            border: 1px transparent solid;
        }
        .progress-indicator:hover {
            border: 1px gray solid;
            cursor: pointer;
        }
        .completed {
            background:#338533;
        }
        .inprogress {
            background:#B2D1B2;
        }
        .not-started {
            background:#D5D5D5;
        }
        .struggling {
            background:#FFCCCC;
        }
        .progressbox {
        	width: 250px;
            display: none;
            position: absolute;
            margin-top: 30px;
            background: #FFFFFF;
        }
        .indicator-icon {
            margin-top: 5px;
            margin-left: 7px;
            color: rgb(43, 43, 43);
            opacity: 0.9;
        }
        .unavailable-content {
            cursor: default;
        }
        
    </style>
{% endblock headcss %}

{% block navbar_topics %}{% endblock navbar_topics %}
{% block navbar_makelink %}{% endblock navbar_makelink %}
{% block navbar_facilities %}{% endblock %}
{% block navbar_groups %}
    {% block navbar_user %}
    {% if student %}
    <div id="select-user" class="selection">
        <span id="user">{{ student.get_name }}</span>
    </div>
    {% endif %}
    {% endblock navbar_user %}
{% endblock navbar_groups %}

{% block content %}
{% block navbar %}{{ block.super }}{% endblock navbar %}

{% block student_report %}
<!-- {% blocktrans %}Last login time: {{ last_login_time }}{% endblocktrans %}-->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            {% if no_data %}
                {% if request.is_admin or is_central %}
                    {% trans "No data for this user." %}
                {% else %}
                    {% trans "Welcome to KA Lite!" %}
                    {% trans "Please return to this page after watching videos or practicing exercises." %}
                {% endif %}
            {% else %}
                <h2>{% trans "Playlist Progress" %}</h2>
            {% endif %}
        </div>
    </div>
    {% if not no_data %}    
        {% for p in playlists %}
        <div class="row">
            <div class="col-xs-12">
                <p><strong>{{ p.title }} <small>{{ p.tag }}</small></strong></p>
                {% for e in p.entries %}
                    {% if e.entity_kind != "Divider" %}
                        <div class="col-xs-2 progress-wrapper">
                            {% if e.entity_kind == "Video" %}
                                {% if e.data.available %}
                                    <a href="{{ e.data.path }}">
                                        <div class="progress-indicator {% if e.data.complete %}completed{% elif e.data.total_seconds_watched > 0 %}inprogress{% else %}not-started{% endif %}" title="{{ e.entity_kind }}: {{ e.data.title }}">
                                            <span class="indicator-icon glyphicon glyphicon-film"></span>
                                        </div>
                                    </a>
                                {% else %}
                                    <div class="unavailable-content progress-indicator {% if e.data.complete %}completed{% elif e.data.total_seconds_watched > 0 %}inprogress{% else %}not-started{% endif %}" title="{{ e.entity_kind }}: {{ e.data.title }} (unavailable)">
                                        <span class="indicator-icon glyphicon glyphicon-film"></span>
                                    </div>
                                {% endif %}
                                <h5>
                                    {{ e.data.title }}
                                </h5>
                            {% elif e.entity_kind == "Exercise" %}
                                <div class="progress-indicator {% if e.data.struggling%}struggling{% elif e.data.complete %}completed{% elif e.data.attempts > 0 %}inprogress{% else %}not-started{% endif %}" title="{{ e.entity_kind }}: {{ e.data.title }}">
                                    <span class="indicator-icon glyphicon glyphicon-pencil"></span>
                                </div>
                                <h6>
                                    {% if e.data.available %}
                                        <a href="{{ e.data.path }}">{{ e.data.title }}</a>
                                    {% else %}
                                        <span class="unavailable" title="Exercise unavailable">{{ e.data.title }}</span>
                                    {% endif %}
                                </h6>
                            {% endif %}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    {% endif %}
</div>
{% endblock student_report %}
{% endblock content %}
